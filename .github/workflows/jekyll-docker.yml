name: Preview
on: pull_request
jobs:
  serve:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Serve via ngrok
        run: |
          # è£…ä¸ªæœ€å° HTTP æœåŠ¡å™¨
          python3 -m http.server 8080 &
          # æŠŠ 8080 æ˜ å°„åˆ°å…¬ç½‘
          curl -s https://ngrok-agent.s3.amazonaws.com/ngrok.zip -o ngrok.zip
          unzip ngrok.zip
          ./ngrok authtoken ${{ secrets.NGROK_TOKEN }}
          ./ngrok http 8080 --log=stdout | tee ngrok.log &
          sleep 5
          PUBLIC_URL=$(grep -o 'https://[0-9a-z]*\.ngrok\.io' ngrok.log | head -1)
          echo "ğŸŒ Live preview: $PUBLIC_URL"
          # è®© job æŒç»­ 5 åˆ†é’Ÿ
          sleep 1000
